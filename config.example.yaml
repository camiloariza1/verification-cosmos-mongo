cosmos:
  api: mongo  # mongo | sql (SQL/Core API uses "id", not "_id")
  database: source_db  # or set COSMOS_DATABASE
  # For Cosmos Mongo API:
  uri: "${COSMOS_URI}"  # or hardcode; env overrides config
  # For Cosmos SQL/Core API:
  # endpoint: "${COSMOS_ENDPOINT}"  # or hardcode; env overrides config
  # key: "${COSMOS_KEY}"            # or hardcode; env overrides config

mongodb:
  uri: "${MONGODB_URI}"  # or hardcode; env overrides config
  database: target_db     # or set MONGODB_DATABASE

collections:
  customers:
    enabled: true
    business_key: customerId
    exclude_fields:
      - _id
      - _etag
      - _ts
      - lastUpdated
    # Optional: treat arrays at these paths as order-insensitive
    # array_order_insensitive_paths:
    #   - "addresses"
  orders:
    enabled: true
    business_key: orderId
    exclude_fields:
      - _id
      - _etag
      - _ts

# Optional defaults used when comparing collections that don't have an explicit entry in `collections`.
# Helpful with `--all-collections` if you want to compare everything using the same key.
collection_defaults:
  enabled: true
  # Cosmos SQL/Core API: usually "id"
  # Cosmos Mongo API: usually "_id"
  business_key: id
  exclude_fields:
    - _etag
    - _ts

sampling:
  # auto | deterministic | fast | bucket
  # - auto: if seed is set -> deterministic, else source-side fast sampling
  # - deterministic: stable hashed-key selection (scans keys)
  # - fast: source-side quick sample (best for very large collections)
  # - bucket: use precomputed indexed bucket field (requires bucket_field + bucket_modulus)
  mode: auto
  # Provide exactly one of:
  percentage: 5
  # count: 500
  # Optional: if provided, deterministic sampling is stable across runs
  seed: 42

  # Progress/throughput controls
  deterministic_scan_log_every: 10000
  # deterministic_max_scan_keys: 200000
  source_lookup_concurrency: 8
  compare_concurrency: 8
  compare_log_every: 1000

  # Optional precomputed bucket sampling (long-term performance path for huge collections)
  # bucket_field: sampleBucket
  # bucket_modulus: 1024
  # bucket_count: 8

  # Cosmos SQL 429 throttling retry controls
  cosmos_retry_max_attempts: 6
  cosmos_retry_base_delay_ms: 500

logging:
  main_log: "compare_summary.log"
  output_dir: "mismatch_logs"
